---
import Layout from "../layouts/Layout.astro";
import Product from "../components/Product.astro";
import Card from "../components/OffreCard.astro";
import { getOffres } from "../js/backend.mjs";
const offres = await getOffres();
console.log(offres);
---

<Layout titre="Offres">
    <h1 class="text-2xl font-bold text-center p-5">Offres</h1>
    <button
        id="favori-button"
        class="bg-slate-600 rounded-lg text-white p-2 cursor-pointer"
        >Afficher les favoris</button
    >
    <ul class="flex flex-col items-center gap-10 p-10">
        {
            offres.map((offre) => (
                <li>
                    <Card offre={offre} />
                </li>
            ))
        }
    </ul>
    <div class="flex-col flex justify-center gap-4 items-center">
        <ul class="flex justify-center gap-4 items-center p-5">
            <li
                class="p-5 bg-blue-900 rounded-xl text-white font-semibold ring-3 ring-blue-500"
            >
                -20€ sur votre première commande
            </li>
            <li
                class="p-5 bg-blue-900 rounded-xl text-white font-semibold ring-3 ring-blue-500"
            >
                -15% sur les commandes de plus de 50€
            </li>
            <li
                class="p-5 bg-blue-900 rounded-xl text-white font-semibold ring-3 ring-blue-500"
            >
                -10% sur tout le site jusqu'au 01/02/2026
            </li>
        </ul>
        <div class="separator w-10/12 h-[3px] mb-7 mt-4 bg-gray-400"></div>
        <h2 class="text-xl font-bold">Nos Produits</h2>
        <div
            class="products-table w-full p-5 flex flex-wrap justify-center gap-4 bg-white"
        >
            <Product
                name="Produit A"
                price="30"
                description="Un super produit A."
            />
            <Product
                name="Produit B"
                price="60"
                description="Un super produit B."
            />
            <Product
                name="Produit C"
                price="100"
                description="Un super produit C."
            />
            <Product
                name="Produit D"
                price="45"
                description="Un super produit D."
            />
            <Product
                name="Produit E"
                price="45"
                description="Un super produit E."
            />
            <Product
                name="Produit F"
                price="45"
                description="Un super produit F."
            />
        </div>
        <div class="separator w-10/12 h-[3px] mb-7 mt-4 bg-gray-400"></div>
        <h2 class="text-xl font-bold">Nos Valeurs</h2>
        <p class="w-10/12 text-center mb-7">
            Chez Mael Brungard, nous nous engageons à offrir des produits de
            qualité tout en respectant l'environnement. Nous croyons en la
            transparence, l'innovation et la satisfaction client. Notre mission
            est de créer une expérience d'achat exceptionnelle tout en
            contribuant positivement à la société.
        </p>
    </div>
    <script>
        const button = document.getElementById("favori-button");
        let showOnlyFavorites = false;

        button?.addEventListener("click", () => {
            showOnlyFavorites = !showOnlyFavorites;
            const offres = document.querySelectorAll(".offre");

            offres.forEach((offre) => {
                const isFavori = offre.dataset.favori === "true";

                if (showOnlyFavorites) {
                    offre.style.display = isFavori ? "block" : "none";
                    button.textContent = "Afficher tout";
                } else {
                    offre.style.display = "block";
                    button.textContent = "Afficher les favoris";
                }
            });
        });

        const checkbox = document.querySelectorAll(".checkbox");
        checkbox.forEach((check) => {
            check.addEventListener("change", () => {
                const id = check.dataset.id;
                const div = document.getElementById(`${id}`);
                const status = check.checked;
                div.classList.add(status ? "bg-amber-500" : "bg-indigo-950");
                div.classList.remove(status ? "bg-indigo-950" : "bg-amber-500");
            });
        });
    </script>
</Layout>
